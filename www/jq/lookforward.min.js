/**
 * Modules in this bundle
 * @license
 *
 * lookforward:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: appleple
 *   homepage: http://developer.a-blogcms.jp
 *   version: 0.1.0
 *
 * es6-object-assign:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Rub√©n Norte <rubennorte@gmail.com>
 *   homepage: https://github.com/rubennorte/es6-object-assign
 *   version: 1.1.0
 *
 * es6-promise-polyfill:
 *   license: MIT (http://opensource.org/licenses/MIT)
 *   author: Roman Dvornov <rdvornov@gmail.com>
 *   version: 1.2.0
 *
 * This header is generated by licensify (https://github.com/twada/licensify)
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.LookForward=e()}}(function(){var e;return function e(t,o,n){function r(a,s){if(!o[a]){if(!t[a]){var d="function"==typeof require&&require;if(!s&&d)return d(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=o[a]={exports:{}};t[a][0].call(u.exports,function(e){var o=t[a][1][e];return r(o||e)},u,u.exports,e,t,o,n)}return o[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t,o){"use strict";function n(e,t){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var o=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var i=Object.keys(Object(r)),a=0,s=i.length;a<s;a++){var d=i[a],c=Object.getOwnPropertyDescriptor(r,d);void 0!==c&&c.enumerable&&(o[d]=r[d])}}return o}function r(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:n})}t.exports={assign:n,polyfill:r}},{}],2:[function(t,o,n){(function(t){!function(t){function o(e){return"[object Array]"===Object.prototype.toString.call(e)}function r(){for(var e=0;e<q.length;e++)q[e][0](q[e][1]);q=[],m=!1}function i(e,t){q.push([e,t]),m||(m=!0,_(r,0))}function a(e,t){function o(e){c(t,e)}function n(e){l(t,e)}try{e(o,n)}catch(e){n(e)}}function s(e){var t=e.owner,o=t.state_,n=t.data_,r=e[o],i=e.then;if("function"==typeof r){o=L;try{n=r(n)}catch(e){l(i,e)}}d(i,n)||(o===L&&c(i,n),o===k&&l(i,n))}function d(e,t){var o;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"==typeof t)){var n=t.then;if("function"==typeof n)return n.call(t,function(n){o||(o=!0,t!==n?c(e,n):u(e,n))},function(t){o||(o=!0,l(e,t))}),!0}}catch(t){return o||l(e,t),!0}return!1}function c(e,t){e!==t&&d(e,t)||u(e,t)}function u(e,t){e.state_===g&&(e.state_=b,e.data_=t,i(h,e))}function l(e,t){e.state_===g&&(e.state_=b,e.data_=t,i(v,e))}function f(e){var t=e.then_;e.then_=void 0;for(var o=0;o<t.length;o++)s(t[o])}function h(e){e.state_=L,f(e)}function v(e){e.state_=k,f(e)}function p(e){if("function"!=typeof e)throw new TypeError("Promise constructor takes a function argument");if(this instanceof p==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],a(e,this)}var y=t.Promise,w=y&&"resolve"in y&&"reject"in y&&"all"in y&&"race"in y&&function(){var e;return new y(function(t){e=t}),"function"==typeof e}();void 0!==n&&n?(n.Promise=w?y:p,n.Polyfill=p):"function"==typeof e&&e.amd?e(function(){return w?y:p}):w||(t.Promise=p);var m,g="pending",b="sealed",L="fulfilled",k="rejected",E=function(){},_="undefined"!=typeof setImmediate?setImmediate:setTimeout,q=[];p.prototype={constructor:p,state_:g,then_:null,data_:void 0,then:function(e,t){var o={owner:this,then:new this.constructor(E),fulfilled:e,rejected:t};return this.state_===L||this.state_===k?i(s,o):this.then_.push(o),o.then},catch:function(e){return this.then(null,e)}},p.all=function(e){var t=this;if(!o(e))throw new TypeError("You must pass an array to Promise.all().");return new t(function(t,o){for(var n,r=[],i=0,a=0;a<e.length;a++)n=e[a],n&&"function"==typeof n.then?n.then(function(e){return i++,function(o){r[e]=o,--i||t(r)}}(a),o):r[a]=n;i||t(r)})},p.race=function(e){var t=this;if(!o(e))throw new TypeError("You must pass an array to Promise.race().");return new t(function(t,o){for(var n,r=0;r<e.length;r++)n=e[r],n&&"function"==typeof n.then?n.then(t,o):t(n)})},p.resolve=function(e){var t=this;return e&&"object"==typeof e&&e.constructor===t?e:new t(function(t){t(e)})},p.reject=function(e){return new this(function(t,o){o(e)})}}("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(o,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),i=e("../lib/util"),a=e("es6-object-assign").assign,s=e("es6-promise-polyfill").Promise,d={classNames:{LookForward:"lookforward",LookForwardBody:"lookforward-body",LookForwardInner:"lookforward-inner",LookForwardClose:"lookforward-close",LookForwardCloseBtn:"lookforward-close-btn",LookForwardHeader:"lookforward-header",LookForwardFooter:"lookforward-footer",LookForwardLoader:"lookforward-loader",LookForwardLoaderWrap:"lookforward-loader-wrap"},closeBtnPattern:1,transitionEnter:"",transitionLeave:"",scrapedArea:"body",useHistoryApi:!0},c=function(){function e(t){var o=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n(this,e),this.options=a({},d,r),this.id=(0,i.getUniqId)();var s="string"==typeof t?document.querySelectorAll(t):t,c=document.querySelector("body");this.currentUrl=location.href,this.selector=t,this.historyLength=0,s&&([].forEach.call(s,function(e){o.addClickEvent(e)}),(0,i.append)(c,'<div id="'+this.id+'"></div>'),window.history&&this.options.useHistoryApi&&window.addEventListener("popstate",function(e){var t=e.state;if(t&&t.pushed){var n=t.transitionEnter,r=t.transitionLeave,a=(0,i.getUniqId)(),s=o.buildHtml(t.html,a,n,r);o.historyLength>=t.historyLength?o.removeModal():o.addModal(s),o.historyLength=t.historyLength}else o.removeModal().then(function(){c.style.overflow="",o._fireEvent("closeAll")})}))}return r(e,[{key:"on",value:function(e,t){var o=this;document.querySelector("#"+this.id).addEventListener(e,function(e){t.call(o,e)})}},{key:"addClickEvent",value:function(e){var t=this;e.addEventListener("click",function(o){o.preventDefault();var n=e.getAttribute("href"),r=e.dataset.transitionEnter||t.options.transitionEnter,a=e.dataset.transitionLeave||t.options.transitionLeave;t.addLoader(),(0,i.fetch)(n).then(function(e){t.removeLoader();var o=e.querySelector(t.options.scrapedArea);if(o){var s=(0,i.getUniqId)(),d=t.buildHtml(o.innerHTML,s,r,a);if(t.addModal(d),window.history&&t.options.useHistoryApi){var c=t.historyLength;window.history.pushState({pushed:!0,html:o.innerHTML,id:s,transitionEnter:r,transitionLeave:a,historyLength:c},"",n)}}})})}},{key:"addLoader",value:function(){var e=this.id,t=this.options.classNames,o=document.querySelector("#"+e),n='<div class="'+t.LookForwardLoaderWrap+'" data-id="loader">\n      <span class="'+t.LookForwardLoader+'"></span>\n    </div>';(0,i.append)(o,n)}},{key:"removeLoader",value:function(){var e=this.id,t=document.querySelector("#"+e),o=t.querySelector('[data-id="loader"]');(0,i.remove)(o)}},{key:"addModal",value:function(e){var t=this,o=this.id,n=this.selector,r=document.querySelector("body"),a=document.querySelector("#"+o);r.style.overflow="hidden",(0,i.append)(a,e);var s=this.getModal(),d=s.querySelector(".js-lookforward-close-btn");if(this.historyLength+=1,d.addEventListener("click",function(){window.history&&t.options.useHistoryApi?window.history.back():t.removeModal()}),"string"==typeof n){var c=s.querySelectorAll(n);[].forEach.call(c,function(e){t.addClickEvent(e)})}return this._fireEvent("open"),s}},{key:"getModals",value:function(){return document.querySelectorAll("#"+this.id+" [data-root]")}},{key:"getModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"last";return document.querySelector("#"+this.id+" [data-root]:"+e+"-child")}},{key:"removeModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"last";return new s(function(o){var n=e.options.classNames,r=document.querySelector("#"+e.id+" [data-root]:"+t+"-child");r||o(),(0,i.addClass)(r,n.LookForwardClose),e.historyLength-=1,setTimeout(function(){(0,i.remove)(r),e._fireEvent("close"),o()},300)})}},{key:"buildHtml",value:function(e,t,o,n){var r=this.options.classNames,i=this.options.closeBtnPattern;return'\n      <div class="'+r.LookForward+'" data-root data-animation id="'+t+'">\n        <button class="'+r.LookForwardCloseBtn+" _pattern"+i+' js-lookforward-close-btn"></button>\n        <div class="'+r.LookForwardBody+'" data-body>\n          <div class="'+r.LookForwardHeader+'">     \n          </div>\n          <div class="'+r.LookForwardInner+" _enter-"+o+" _leave-"+n+'">\n            '+e+'\n          </div>\n          <div class="'+r.LookForwardFooter+'">\n          </div>\n        </div>\n      </div>\n    '}},{key:"_fireEvent",value:function(e){var t=document.querySelector("#"+this.id);(0,i.triggerEvent)(t,e)}}]),e}();o.default=c,t.exports=o.default},{"../lib/util":5,"es6-object-assign":1,"es6-promise-polyfill":2}],4:[function(e,t,o){"use strict";t.exports=e("./core/")},{"./core/":3}],5:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=e("es6-promise-polyfill").Promise;o.fetch=function(e){return new n(function(t,o){var n=new XMLHttpRequest;n.onload=function(){t(n.response)},n.onerror=function(){o()},n.open("GET",e),n.responseType="document",n.send()})},o.append=function(e,t){var o=new DOMParser,n=o.parseFromString(t,"text/html");e.appendChild(n.querySelector("body").childNodes[0])},o.prepend=function(e,t){var o=new DOMParser,n=o.parseFromString(t,"text/html");e.insertBefore(n.querySelector("body").childNodes[0],e.firstChild)},o.getUniqId=function(){return(Date.now().toString(36)+Math.random().toString(36).substr(2,5)).toUpperCase()},o.remove=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},o.addClass=function(e,t){e.classList?e.classList.add(t):e.className+=" "+t},o.triggerEvent=function(e,t,o){var n=void 0;window.CustomEvent?n=new CustomEvent(t,{cancelable:!0}):(n=document.createEvent("CustomEvent"),n.initCustomEvent(t,!1,!1,o)),e.dispatchEvent(n)}},{"es6-promise-polyfill":2}]},{},[4])(4)});